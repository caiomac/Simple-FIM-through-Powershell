# Elastic SIEM Setup and Monitoring

## Description
This project involves setting up an Elastic SIEM instance to monitor security events. It starts by creating an Elastic Cloud deployment and configuring a Kali Linux virtual machine in Oracle VirtualBox. Logs are collected using the Elastic Agent installed on the VM, forwarding data to the SIEM. Security events, such as those generated by Nmap scans, are analyzed using queries in Elastic SIEM. Custom dashboards and visualizations are created to display patterns over time, and alerts are configured to notify of specific events, such as Nmap scans, via email.

*Estimated completion time: 2 hours*

---

## Objectives
- Practical learning in setting up and utilizing Elastic SIEM.
- Skills in cloud deployment, log collection, and SIEM integration.
- Analysis of security events, dashboard creation, and real-time alert configuration.

---

## Skills Learned
- Cloud Deployment
- Virtualization
- Log Collection and Integration
- Dashboard Creation
- Alert Configuration
- SIEM Operations

---

## Tools Used
- **Elastic Cloud**: For deploying and managing the Elastic SIEM instance.
- **Elastic Agent**: For collecting and forwarding logs to the SIEM.
- **Kali Linux**: As the virtual machine for generating and testing security events.
- **Oracle VirtualBox**: For setting up and running the Kali Linux VM.
- **Nmap**: For generating security events through network scanning.
- **Linux Terminal**: For configuration and security tool execution.
- **Email Services**: For receiving notifications triggered by configured alerts.

---

## Walkthrough

### Step 1 - Setting up an Elastic Account
1. Create a free Elastic Cloud account at [Elastic Cloud Registration](https://cloud.elastic.co/registration).
2. Log in to the Elastic Cloud console and create a new **Elasticsearch** deployment.

![Elastic Cloud Deployment](assets/elastic-deployment.png)

---

### Step 2 - Setting up the Linux VM
1. Download the Kali Linux VM from the [official website](https://www.kali.org/get-kali/#kali-virtual-machines).
2. Import the VM into Oracle VirtualBox and complete the setup.

![VirtualBox Setup](assets/virtualbox-setup.png)

---

### Step 3 - Setting up the Elastic Agent
1. Install the Elastic Agent on the Kali VM by navigating to **Integrations** in the Elastic Cloud dashboard.
2. Follow the instructions for the **Elastic Defend** integration to install and configure the agent.

![Elastic Agent Installation](assets/elastic-agent-setup.png)

---

### Step 4 - Generating Security Events on the Kali VM
1. Use tools like **Nmap** to generate security-related events.
2. Example: `sudo nmap <IP_ADDRESS>`.

![Nmap Scan](assets/nmap-scan.png)

---

### Step 5 - Querying for Security Events in Elastic SIEM
1. Access the **Logs** tab under **Observability** in the Elastic deployment.
2. Use queries like `event.action: "nmap_scan"` to analyze specific events.

![Query Logs](assets/query-logs.png)

---

### Step 6 - Creating a Dashboard
1. Navigate to **Dashboards** under **Analytics** in the Elastic Cloud portal.
2. Create visualizations to track event patterns over time.

![Custom Dashboard](assets/custom-dashboard.png)

---

### Step 7 - Creating an Alert
1. Under **Security**, go to **Alerts** and create a new rule with a custom query.
2. Configure the alert to send an email notification upon detecting Nmap scans.

![Create Alert](assets/create-alert.png)

---

## Summary
This project demonstrated the setup and use of Elastic SIEM for security monitoring. Tasks included deploying an Elastic Cloud instance, configuring a VM, collecting logs, querying and analyzing security events, and setting up dashboards and alerts to simulate a real-world cybersecurity scenario.

---

### License
[MIT License](LICENSE)

---
